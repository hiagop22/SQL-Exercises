# SQL Practice Repository

This repository contains a collection of SQL questions and answers to showcase my skills in SQL. 

The questions were generated with the assistance of ChatGPT, a language model developed by OpenAI.
While the questions were generated by the AI model, all answers provided here were crafted by me to demonstrate my SQL skills.


## Database
The questions are based on a database obtained from [Database Source Website](https://medium.com/blog-do-zouza/sql-for-data-analysis-e8d0356ecd3c).

The database used contains the following tables:

- **fato_vendas**: Contains information about sales transactions.

    | CodigoVenda | DataVenda | CodigoCliente | CodigoProduto | Quantidade | ValorUnitario | CodigoVendedor | CodigoCanalVendas | CodigoStatus | Deletado |
    |----|------------|---------|----------|--------|-------|----------|-----|-----|-------|
    | 1  | 2010-02-01 | 1       | 1        | 4000   | 0.34  | 2        | 1   | 1   | 0     |
    | 2  | 2010-02-01 | 1       |          | 4000   | 0.34  | 2        | 1   | 1   | 0     |
    | 3  | 2010-02-01 | 5       | 1        | 4200   | 0.34  | 4        | 1   | 1   | 0     |
    | 4  | 2010-02-02 | 3       | 2        | 250    | 7.00  | 2        | 1   | 1   | 0     |
    | 5  | 2010-02-03 | 4       | 1        | 4500   | 0.34  | 1        | 1   | 1   | 0     |

- **dim_produto**: Stores details about products

    | CodigoProduto | NomeProduto    | TipoProduto | UnidadeProduto | SaldoProduto | Status |
    |----|------------|----------|------|----------|--------|
    | 1  | Produto A  | A        | KG   | 20000    | Ativo  |
    | 2  | Produto C  | A        | KG   | 5000     | Ativo  |
    | 3  | Produto E  | B        | KG   | 2000     | Ativo  |
    | 4  | Produto SL | A        | KG   | 30000    | Ativo  |
    | 5  | Produto CH | A        | KG   | 2000     | Ativo  |


- **dim_cliente**: Holds information about customers.

    | CodigoCliene | NomeCliente     | Idade | Classificacao | Sexo | Cidade             | Estado               | Pais |
    |----|-------------|-----|-------|--------|------------------|---------------------|---------|
    | 1  | Cliente AA  | 30  | 3     | M      | Florianópolis    | Santa Catarina      | Brasil  |
    | 2  | Cliente EF  | 31  | 3     | M      | Belo Horizonte   | Minas Gerais        | Brasil  |
    | 3  | Cliente BC  | 25  | 4     | M      | Baturité          | Ceará               | Brasil  |
    | 4  | Cliente CC  | 19  | 2     | F      | Fortaleza        | Ceará               | Brasil  |
    | 5  | Cliente BB  | 20  | 2     | F      | Belo Horizonte   | Minas Gerais        | Brasil  |

## Questions

1. Retrieve the top 5 products with the highest total sales amount. Include the product name and the total sales amount.
   - [Answer 1](answer_01.sql)

2. For each year, find the month with the highest total sales amount. Display the year, month, and total sales.
   - [Answer 2](answer_02.sql)

3. Calculate the cumulative sum of sales (Quantidade * ValorUnitario) for each product over time. Display the product code, date, and cumulative sales along the days for each product.
    - [Answer 3](answer_03.sql)

4. List the top 3 salespersons who have made sales in the most distinct product categories. Include the salesperson code and the number of distinct categories.
    - [Answer 4](answer_04.sql)

5. Find the products that have experienced a sales increase of more than 50% from the previous month. Display the product code, month, and the percentage increase.
    - [Answer 5](answer_05.sql)

6.  Retrieve the customers who have made purchases in the year 2022. Display the customer code and name.
    - [Answer 6](answer_06.sql)

7. Calculate the average time between consecutive purchases for each customer. Display the customer code and the average time in days.
    - [Answer 7](answer_07.sql)

8. Identify the products that have not been that have not been sold in the last 6 months since the most recent purchase. Display the product code and name.
    - [Answer 8](answer_08.sql)

9. Find the customers who have made at least two consecutive purchases of the same product. Display the customer code, product code, and purchase dates.
    - [Answer 9](answer_09.sql)

10. List the products that have the highest average sales value (sales amount divided by quantity) in each product category. Display the category, product code, and average sales value.
    - [Answer 10](answer_10.sql)



## Folder Structure

- **SQL_Practice/**
  - answer1.sql
  - answer2.sql
  - answer3.sql
  - ...

Feel free to explore each question and its corresponding answer to understand my approach to SQL problem-solving.
